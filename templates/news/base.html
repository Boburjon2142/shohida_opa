<!DOCTYPE html>
{% load static %}
{% load i18n %}
<html>
<head>
<title>{% block title%} {% endblock title %}</title>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="{% static 'css/bootstrap.min.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'css/font-awesome.min.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'css/animate.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'css/font.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'css/li-scroller.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'css/slick.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'css/jquery.fancybox.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'css/theme.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'css/style.css' %}">
<!-- Custom overrides come last -->
<link rel="stylesheet" type="text/css" href="{% static 'css/custom.css' %}">
<link rel="icon" type="image/png" href="{% static 'images/logo.png' %}">

<style>
  /* Lightweight spacing/polish for header buttons */
  .language-form { display: inline-flex; align-items: center; gap: 6px; margin: 0; }
  .auth-actions { display: flex; align-items: center; justify-content: flex-end; gap: 8px; flex-wrap: wrap; margin: 0; }
  .auth-actions .btn { margin: 0; height: 38px; padding: 7px 14px; line-height: 24px; border-radius: 12px; }
  .auth-actions .btn-group .btn { height: 38px; padding: 7px 14px; }
  .auth-actions form { display: inline; margin: 0; }
  .navbar-form { margin: 0; padding: 0; }
  .navbar-form .form-control { height: 38px; }
  .navbar-form .btn { height: 38px; padding: 7px 14px; }
  .top_nav { display: flex; flex-wrap: wrap; gap: 10px; align-items: center; }
  .top_nav li { list-style: none; }
  .top_nav a.btn { color: #fff !important; }
  /* Language selector aligned with auth buttons */
  .language-form .form-control {
    background: linear-gradient(135deg, #00a6c0, #5b43bf);
    color: #fff;
    border: 1px solid rgba(255,255,255,0.18);
    font-weight: 700; /* bold text */
    height: 38px;
    padding: 7px 14px;
    border-radius: 12px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.08);
  }
  .language-form .form-control:focus {
    background: linear-gradient(135deg, #00b3d1, #6c57d6);
    color: #fff;
    border-color: #5b43bf;
    box-shadow: 0 0 0 2px rgba(91,67,191,0.18);
  }
  /* Ensure dropdown options remain readable */
  .language-form select option { color: #000; }
  @media (max-width: 768px) {
    .auth-actions { justify-content: flex-start; margin-top: 8px; }
  }
</style>

</head>
<body>
<div id="preloader">
  <div id="status">&nbsp;</div>
</div>
<a class="scrollToTop" href="#"><i class="fa fa-angle-up"></i></a>
<div class="container-fluid">
  <header id="header">
    <div class="row">
      <div class="col-lg-12 col-md-12 col-sm-12">
        <div class="header_top">
          <div class="header_top_left">
            <div class="logo_area">
              <a href="{% url 'home_page' %}"><img src="{% static 'images/logo.png' %}" alt="Logo"></a>
            </div>
            <button type="button" class="navbar-toggle mobile-navbar-toggle" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <ul class="top_nav">
              <li><a href="{% url 'home_page' %}">{% trans "Bosh sahifa" %}</a></li>
              <li><a href="{% url 'about_page' %}">{% trans "Biz haqimizda" %}</a></li>
              <li><a href="{% url 'contact_page' %}">{% trans "Aloqa" %}</a></li>
              {% if user.is_authenticated %}
              <li><a href="{% url 'admin_page' %}">{% trans "Admin sahifasi" %}</a></li>
              {% endif %}
            </ul>
          </div>
          <div class="header_top_right" style="display: flex; gap: 15px; flex-wrap: wrap; justify-content: flex-end; align-items: center;">
            <div style="flex-grow: 1; min-width: 200px; margin-top: 8px;">
                <form action="{% url 'set_language' %}" method="post" class="language-form" aria-label="Tilni tanlash">
                  {% csrf_token %}
                  <input name="next" type="hidden" value="{{ redirect_to }}">
                  <select name="language" class="form-control input-sm" onchange="this.form.submit()">
                      {% get_current_language as LANGUAGE_CODE %}
                      {% get_available_languages as LANGUAGES %}
                      {% get_language_info_list for LANGUAGES as languages %}
                      {% for language in languages %}
                          <option value="{{ language.code }}"{% if language.code == LANGUAGE_CODE %} selected{% endif %}>
                              {{ language.name_local }} ({{ language.code }})
                          </option>
                      {% endfor %}
                   </select>
                   
                </form>
            </div>
            <div class="auth-actions" style="align-items: center; padding-top: 8px;">
              {% if user.is_authenticated %}
                <div class="btn-group btn-group-sm" role="group" aria-label="Foydalanuvchi amallari">
                  <a href="{% url 'user_profile' %}" class="btn btn-success btn-profile" aria-label="{% trans "Profil" %}">
                    <i class="fa fa-user"></i> {% trans "Profil" %}
                  </a>
                  <form method="post" action="{% url 'logout' %}" aria-label="{% trans "Chiqish" %}">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-success btn-logout">
                      <i class="fa fa-sign-out"></i> {% trans "Chiqish" %}
                    </button>
                  </form>
                </div>
              {% else %}
                <div class="btn-group btn-group-sm" role="group" aria-label="Kirish va ro'yxatdan o'tish">
                  <a href="{% url 'login' %}" class="btn btn-primary" aria-label='{% trans "Kirish" %}'>
                    <i class="fa fa-sign-in"></i> {% trans "Kirish" %}
                  </a>
                  <a href="{% url 'user_register' %}" class="btn btn-success btn-register" aria-label='{% trans "Ro'yxatdan o'tish" %}'>
                    <i class="fa fa-user-plus"></i> {% trans "Ro'yxatdan o'tish" %}
                  </a>
                </div>
              {% endif %}
            </div>

          </div>
        </div>
      </div>
      
    </div>

    <nav class="navbar navbar-inverse" role="navigation">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button>
      </div>
      <div id="navbar" class="navbar-collapse collapse" style="display: flex; justify-content: space-between; align-items: center;">
        <div>
          <ul class="nav navbar-nav main_nav">
            <li class="active"><a href="{% url 'home_page' %}"><span class="fa fa-home desktop-home"></span><span class="mobile-show">Home</span></a></li>
            {% for cat in nav_categories %}
              <li><a href="{% url 'search_results' %}?q={{ cat }}">{{ cat }}</a></li>
            {% endfor %}
          </ul>
        </div>
        <div style="margin-right: 16px;">
            <form method="get" action="{% url 'search_results' %}" class="navbar-form navbar-right" role="search" aria-label="Sayt bo'ylab qidirish">
              <div class="input-group input-group-sm">
                <input type="text" name="q" class="form-control" style="margin-top:10px" placeholder="{% trans 'Qidiruv...' %}" aria-label="{% trans 'Qidiruv' %}"/>
                <span class="input-group-btn" style="margin-top:9.5px">
                  <button type="submit" class="btn btn-primary" style="height:40px"><i class="fa fa-search"></i></button>
                </span>
              </div>
            </form>
        </div>
      </div>
    </nav>
</header>
  <section id="newsSection">
    <div class="row">
      <div class="col-lg-12 col-md-12">
        <div class="latest_newsarea"> <span>{% trans "So'ngi yangiliklar" %}</span>
          <ul id="ticker01" class="news_sticker">
            {% for news in latest_news %}
            <li>
              <a href="#">
                {% if news.image %}
                  <img src="{{ news.image.url }}" alt="">{{ news.title }}
                {% else %}
                  <img src="{% static 'images/featured_img1.jpg' %}" alt="">{{ news.title }}
                {% endif %}
              </a>
            </li>
            {% endfor %}
          {% comment %} </ul>
          <div class="social_area">
            <ul class="social_nav" style="display: flex; gap: 10px; text-align: center;">
              <li class="facebook"><a href="#" aria-label="Facebook"><i class="fa fa-facebook"></i></a></li>
              <li class="twitter"><a href="#" aria-label="Twitter / X"><i class="fa fa-twitter"></i></a></li>
              <li class="flickr"><a href="#" aria-label="Flickr"><i class="fa fa-flickr"></i></a></li>
              <li class="pinterest"><a href="#" aria-label="Pinterest"><i class="fa fa-pinterest"></i></a></li>
              <li class="googleplus"><a href="#" aria-label="Google Plus"><i class="fa fa-google-plus"></i></a></li>
              <li class="vimeo"><a href="#" aria-label="Vimeo"><i class="fa fa-vimeo-square"></i></a></li>
              <li class="youtube"><a href="#" aria-label="YouTube"><i class="fa fa-youtube"></i></a></li>
              <li class="mail"><a href="#" aria-label="Email"><i class="fa fa-envelope"></i></a></li>
            </ul> {% endcomment %}
          </div>
        </div>
      </div>
    </div>
  </section>
{% block content %}

{% endblock content %}
<!--  Footer-->
  <footer id="footer">
    <div class="footer_top">
      <div class="row">
        <div class="col-lg-4 col-md-4 col-sm-4">
          <div class="footer_widget wow fadeInLeftBig">
            <h2>{{ footer_blocks.flickr.title|default:"Flickr Images" }}</h2>
            {% if footer_blocks.flickr.description %}
              <p>{{ footer_blocks.flickr.description }}</p>
            {% endif %}
          </div>
        </div>
        <div class="col-lg-4 col-md-4 col-sm-4">
          <div class="footer_widget wow fadeInDown">
            <h2>{% trans "Kategoriyani tanlang" %}</h2>
            <ul class="tag_nav">
              {% for category in categories %}
              <li><a href="{% url 'search_results' %}?q={{ category.name }}"> {{ category.name|upper }} </a></li>
              {% endfor %}
            </ul>
          </div>
        </div>
        <div class="col-lg-4 col-md-4 col-sm-4">
          <div class="footer_widget wow fadeInRightBig">
            <h2>{{ footer_blocks.about.title|default:_("Men bilan aloqa") }}</h2>
            {% if footer_blocks.about.description %}
              <p>{{ footer_blocks.about.description }}</p>
            {% else %}
              <p> Abdug'aniyev Boburjon Akramjon o'g'li (Qarshi davlat universiteti inkubatsiya markazi)ga aloqador barcha yangiliklarni kuzatib boring.</p>
              <address>
              Qarshi davlat universiteti . Phone: +998 91 963 07 70 Email: boburjonabduganiyev83@gmail.com
              </address>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
    <div class="footer_bottom">
      <p class="copyright">Copyright &copy; 2025 <a href="index.html">NewsFeed</a></p>
      <p class="developer">{% trans "Developed By Boburjon Akramjonovich" %}</p>
    </div>
  </footer>
</div>
{% block javascript %}
<script src="{% static 'js/jquery.min.js' %}"></script>
<script src="{% static 'js/wow.min.js' %}"></script>
<script src="{% static 'js/bootstrap.min.js' %}"></script>
<script src="{% static 'js/slick.min.js' %}"></script>
<script src="{% static 'js/jquery.li-scroller.1.0.js' %}"></script>
<script src="{% static 'js/jquery.newsTicker.min.js' %}"></script>
<script src="{% static 'js/jquery.fancybox.pack.js' %}"></script>
<script src="{% static 'js/custom.js' %}"></script>
<script src="{% static 'js/html5shiv.min.js' %}"></script>
<script src="{% static 'js/respond.min.js' %}"></script>
<script>
  // Auto-submit language switcher on change
  document.addEventListener('DOMContentLoaded', function () {
    var form = document.querySelector('.language-form');
    if (!form) return;
    var select = form.querySelector('select[name="language"]');
    if (!select) return;
    select.addEventListener('change', function () {
      var nextInput = form.querySelector('input[name="next"]');
      if (nextInput) {
        try {
          nextInput.value = window.location.pathname + window.location.search + window.location.hash;
        } catch (e) { /* noop */ }
      }
      form.submit();
    });
  });
  </script>
  <script>
  // Technology sidebar sizing
  document.addEventListener('DOMContentLoaded', function () {
    function resizeTechSidebar() {
      var el = document.querySelector('.technology-sidebar-fill');
      if (!el) return;
      // If marked as fixed to items count, don't force height
      if (el.hasAttribute('data-fixed-items')) {
        el.style.minHeight = 'auto';
        el.style.maxHeight = 'none';
        var listEl = el.querySelector('.spost_nav');
        if (listEl) {
          listEl.style.maxHeight = 'none';
          listEl.style.overflowY = 'visible';
        }
        return;
      }
      var rect = el.getBoundingClientRect();
      var viewport = window.innerHeight || document.documentElement.clientHeight;
      var available = Math.max(200, viewport - rect.top - 10); // 10px bottom padding
      el.style.minHeight = available + 'px';
      el.style.maxHeight = available + 'px';
      var list = el.querySelector('.spost_nav');
      if (list) {
        var h2 = el.querySelector('h2');
        var headerH = h2 ? h2.offsetHeight : 0;
        var inner = Math.max(120, available - headerH - 16);
        list.style.maxHeight = inner + 'px';
        list.style.overflowY = 'auto';
      }
    }
    resizeTechSidebar();
    window.addEventListener('resize', resizeTechSidebar);
    window.addEventListener('scroll', resizeTechSidebar, { passive: true });
  });

  // Ads carousel
  document.addEventListener('DOMContentLoaded', function () {
    var adCarousel = document.querySelector('.ad-carousel');
    if (!adCarousel || !window.jQuery || !jQuery.fn.slick) return;
    jQuery(adCarousel).slick({
      dots: true,
      arrows: false,
      autoplay: true,
      autoplaySpeed: 4000,
      adaptiveHeight: true,
      pauseOnHover: true,
    });
  });

  // Mobile menu toggle: show/hide language/auth/search when menu opened
  document.addEventListener('DOMContentLoaded', function () {
    var toggle = document.querySelector('.mobile-navbar-toggle');
    var body = document.body;
    if (!toggle) return;
    toggle.addEventListener('click', function () {
      body.classList.toggle('menu-open');
    });
  });
  </script>
{% endblock javascript %}
</body>
</html>
